{{ 'accordion.css' | asset_url | stylesheet_tag }}

<div class="faq">
        <div class="page-width">
            <div class="left-section">
                <p>FREQUENTLY ASKED QUESTIONS</p>
            </div>

            <div class="accordion-section">
                {% for block in section.blocks %}
                <div class="accordion-box">
                    {% if block.settings.question != blank %}<span>{{ block.settings.question }}<i class="icon"></i></span>{% endif %}

                    {% if block.settings.answer != blank %}<div class="answer-text">{{ block.settings.answer }}</div>{% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    {% schema %}
{
  "name": "Accordion",
  "settings": [],
  "blocks": [
    {
      "type": "accordion",
      "name": "faq",
      "limit": 7,
      "settings": [
        { "type": "text", "id": "question", "label": "Question" },
        { "type": "richtext", "id": "answer", "label": "Answer" },
        { "type": "image_picker", "id": "icon", "label": "Question Icon" }
      ]
    }
  ],
  "presets": [{ "name": "Accordion" }]
}
{% endschema %}


    <script>
document.querySelectorAll('.accordion-box span').forEach(span => {
    const box = span.parentElement;
    const content = span.nextElementSibling;

    span.style.cursor = 'pointer';

    // Initialize content height
    content.style.height = '0px';
    content.style.overflow = 'hidden';
    content.style.transition = 'height 0.3s ease';

    span.addEventListener('click', () => {
        const isOpen = box.classList.contains('active');

        if (isOpen) {
            // Closing
            content.style.height = content.scrollHeight + 'px'; // Set to current height for transition
            requestAnimationFrame(() => {
                content.style.height = '0px';
            });
            box.classList.remove('active');
        } else {
            // Opening
            content.style.height = content.scrollHeight + 'px';
            content.addEventListener('transitionend', function handler() {
                content.style.height = 'auto'; // Allow dynamic content height
                content.removeEventListener('transitionend', handler);
            });
            box.classList.add('active');
        }
    });
});
</script>
