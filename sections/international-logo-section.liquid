{{ 'international-logo-section.css' | asset_url | stylesheet_tag }}
{{ 'international-responsive.css' | asset_url | stylesheet_tag }}

<div class="international-network">
  <div class="page-width">
    <div class="network-text">
      <p class="network-heading">{{ section.settings.heading | default: "NUTRIFACTOR CAN BE FOUND ON THESE LARGEST NETWORKS" }}</p>
      <hr>
      <p>{{ section.settings.description | default: "Through sheer determination and constant hard work, Nutrifactor has been featured by some of the largest networks & business journals. Expanding its business to over 60 countries across the globe in 6 different continents, Nutrifactor is on its way to becoming a globally renowned brand." }}</p>
    </div>

    <div class="network-banner logos-per-{{ section.settings.logos_per_row }}">
      {% for block in section.blocks %}
        {% if block.type == 'logo' %}
          <img src="{{ block.settings.logo | image_url }}" alt="{{ block.settings.alt_text }}">
        {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Logo Section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "NUTRIFACTOR CAN BE FOUND ON THESE LARGEST NETWORKS"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Through sheer determination and constant hard work, Nutrifactor has been featured by some of the largest networks & business journals. Expanding its business to over 60 countries across the globe in 6 different continents, Nutrifactor is on its way to becoming a globally renowned brand."
    },
    {
      "type": "range",
      "id": "logos_per_row",
      "label": "Logos per row",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 5
    }
  ],
  "blocks": [
    {
      "type": "logo",
      "name": "Logo",
      "limit": 5,
      "settings": [
        {
          "type": "image_picker",
          "id": "logo",
          "label": "Logo image"
        },
        {
          "type": "text",
          "id": "alt_text",
          "label": "Alt text",
          "default": "Network logo"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Logo Section",
      "category": "International Section"
    }
  ]
}
{% endschema %}

<script>
function initLogoCarousel(banner) {
  if (!banner) return;

  if (window.innerWidth <= 767) {
    banner.style.overflowX = 'auto';
    banner.style.scrollSnapType = 'x mandatory';
    banner.style.display = 'flex';
    banner.style.gap = '20px';
    banner.style.justifyContent = 'flex-start';
    banner.style.padding = '10px 15px';

    // Apply scroll-snap to children
    banner.querySelectorAll('img').forEach(img => {
      img.style.flex = '0 0 auto';
      img.style.scrollSnapAlign = 'center';
    });

    // Drag-to-scroll (for desktop testing)
    let isDown = false;
    let startX;
    let scrollLeft;

    banner.addEventListener('mousedown', e => {
      isDown = true;
      startX = e.pageX - banner.offsetLeft;
      scrollLeft = banner.scrollLeft;
    });

    banner.addEventListener('mouseleave', () => isDown = false);
    banner.addEventListener('mouseup', () => isDown = false);
    banner.addEventListener('mousemove', e => {
      if (!isDown) return;
      e.preventDefault();
      const x = e.pageX - banner.offsetLeft;
      const walk = (x - startX) * 1.5;
      banner.scrollLeft = scrollLeft - walk;
    });
  }
}

// ✅ Run on page load
document.addEventListener('DOMContentLoaded', function () {
  const banner = document.querySelector('.network-banner');
  initLogoCarousel(banner);
});

// ✅ Run again if Shopify dynamically reloads the section
document.addEventListener('shopify:section:load', function (event) {
  const banner = event.target.querySelector('.network-banner');
  initLogoCarousel(banner);
});
</script>