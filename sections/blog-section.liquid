{{ 'blog-section.css' | asset_url | stylesheet_tag }}
<div class="blog-section">
  <div class="container">


    <div class="blog-heading">
      <h2>{{ section.settings.heading }}</h2>
    </div>

    {% assign selected_blog = blogs[section.settings.blog] %}
    {% assign articles = selected_blog.articles %}

    {% if articles.size > 0 %}
      {% assign main_article = articles.first %}
    {% endif %}


    <div class="main-blog">

      <div class="phone-carousel-btns">
        {% if section.settings.arrow_left %}
          <a href="#" class="prev-carousel-btn"><img src="{{ section.settings.arrow_left | img_url }}" alt="Left"></a>
        {% endif %}
        {% if section.settings.arrow_right %}
          <a href="#" class="next-carousel-btn"><img src="{{ section.settings.arrow_right | img_url }}" alt="Right"></a>
        {% endif %}
      </div>

      <div class="main-blog-image">
        {% if main_article.image %}
          <a href="{{ main_article.url }}">
            <img 
              src="{{ main_article.image | img_url: '2048x2048' }}"
              alt="{{ main_article.title }}"
              loading="lazy"
            >
          </a>
        {% endif %}
      </div>

      <div class="main-blog-text">
        <span>

 
          <p class="sub-heading">
            {% if main_article.tags.size > 0 %}
              {% assign main_tag = main_article.tags.first | downcase %}
              {% assign main_tag_icon = selected_blog.metafields.tag_icons[main_tag] %}

              {% if main_tag_icon %}
                <img src="{{ main_tag_icon | img_url }}" alt="{{ main_article.tags.first }}">
              {% else %}
                <img src="{{ section.settings.category_icon | img_url }}">
              {% endif %}

              {{ main_article.tags.first }}
            {% else %}
              {% if section.settings.category_icon_custom %}
                <img src="{{ section.settings.category_icon_custom | img_url }}" alt="{{ section.settings.category_text }}">
              {% else %}
                <img src="{{ section.settings.category_icon | img_url }}">
              {% endif %}
              {{ section.settings.category_text }}
            {% endif %}
          </p>


          <h2>{{ main_article.title }}</h2>

          <p>
            {% if main_article.excerpt != blank %}
              {{ main_article.excerpt }}
            {% else %}
              {{ main_article.content | strip_html | truncate: 140 }}
            {% endif %}
          </p>
        </span>

        <strong>
          <p>{{ main_article.published_at | date: "%b %d, %Y" }}</p>
          <a href="{{ main_article.url }}">Read More</a>
        </strong>
      </div>
    </div>


    <div class="blog-carousel-section">

      <div class="carousel-btns">
        {% if section.settings.arrow_left %}
          <a href="#" class="prev-carousel-btn"><img src="{{ section.settings.arrow_left | img_url }}" alt="Left"></a>
        {% endif %}
        {% if section.settings.arrow_right %}
          <a href="#" class="next-carousel-btn"><img src="{{ section.settings.arrow_right | img_url }}" alt="Right"></a>
        {% endif %}
      </div>

      {% for article in articles offset:1 limit: section.settings.carousel_limit %}
        <div class="carousel-blog">

          <div class="carousel-blog-image">
            {% if article.image %}
              <a href="{{ article.url }}">
                <img 
                  src="{{ article.image | img_url }}"
                  alt="{{ article.title }}"
                  loading="lazy"
                >
              </a>
            {% endif %}
          </div>

          <div class="carousel-blog-text">
            <span>
              <p class="sub-heading">
                {% if article.tags.size > 0 %}
                  {% assign tag = article.tags.first | downcase %}
                  {% assign tag_icon = selected_blog.metafields.tag_icons[tag] %}

                  {% if tag_icon %}
                    <img src="{{ tag_icon | img_url }}" alt="{{ article.tags.first }}">
                  {% else %}
                    <img src="{{ section.settings.category_icon | img_url }}">
                  {% endif %}

                  {{ article.tags.first }}
                {% else %}
                  {% if section.settings.category_icon_custom %}
                    <img src="{{ section.settings.category_icon_custom | img_url }}" alt="{{ section.settings.category_text }}">
                  {% else %}
                    <img src="{{ section.settings.category_icon | img_url }}">
                  {% endif %}
                  {{ section.settings.category_text }}
                {% endif %}
              </p>


              <h2>{{ article.title }}</h2>

              <p>
                {% if article.excerpt != blank %}
                  {{ article.excerpt }}
                {% else %}
                  {{ article.content | strip_html | truncate: 90 }}
                {% endif %}
              </p>
            </span>

            <strong>
              <p>{{ article.published_at | date: "%b %d, %Y" }}</p>
              <a href="{{ article.url }}">Read More</a>
            </strong>
          </div>
        </div>
      {% endfor %}
    </div>

  </div>
</div>

{% schema %}
{
  "name": "Featured Blog Section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Wellness Blog"
    },
    {
      "type": "blog",
      "id": "blog",
      "label": "Select Blog"
    },
    {
      "type": "text",
      "id": "category_text",
      "label": "Category Text",
      "default": "Health"
    },
    {
      "type": "image_picker",
      "id": "category_icon_custom",
      "label": "Category Icon"
    },
    {
      "type": "image_picker",
      "id": "arrow_left",
      "label": "Left Arrow Icon"
    },
    {
      "type": "image_picker",
      "id": "arrow_right",
      "label": "Right Arrow Icon"
    },
    {
      "type": "image_picker",
      "id": "category_icon",
      "label": "Default Category Icon"
    },
    {
      "type": "range",
      "id": "carousel_limit",
      "min": 1,
      "max": 10,
      "step": 1,
      "default": 2,
      "label": "Number of carousel articles"
    }
  ],

  "presets": [
    {
      "name": "Featured Blog Section",
      "category": "Homepage"
    }
  ]
}
{% endschema %}